{"ast":null,"code":"import _regeneratorRuntime from\"/Users/rdrouet/Documents/PERSONNEL/OCR/OCR-P7/mon-vieux-grimoire/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/rdrouet/Documents/PERSONNEL/OCR/OCR-P7/mon-vieux-grimoire/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/rdrouet/Documents/PERSONNEL/OCR/OCR-P7/mon-vieux-grimoire/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import axios from'axios';import{useNavigate}from'react-router-dom';import{API_ROUTES,APP_ROUTES}from'../../utils/constants';import{useUser}from'../../lib/customHooks';import{storeInLocalStorage}from'../../lib/common';import{ReactComponent as Logo}from'../../images/Logo.svg';import styles from'./SignIn.module.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function SignIn(_ref){var setUser=_ref.setUser;var navigate=useNavigate();var _useUser=useUser(),user=_useUser.user,authenticated=_useUser.authenticated;if(user||authenticated){navigate(APP_ROUTES.DASHBOARD);}var _useState=useState(''),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var _useState7=useState({error:false,message:''}),_useState8=_slicedToArray(_useState7,2),notification=_useState8[0],setNotification=_useState8[1];var signIn=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _response$data,response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setIsLoading(true);_context.next=4;return axios({method:'post',url:API_ROUTES.SIGN_IN,data:{email:email,password:password}});case 4:response=_context.sent;if(!(response!==null&&response!==void 0&&(_response$data=response.data)!==null&&_response$data!==void 0&&_response$data.token)){setNotification({error:true,message:'Une erreur est survenue'});console.log('Something went wrong during signing in: ',response);}else{storeInLocalStorage(response.data.token,response.data.userId);setUser(response.data);navigate('/');}_context.next=13;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);console.log(_context.t0);setNotification({error:true,message:_context.t0.message});console.log('Some error occured during signing in: ',_context.t0);case 13:_context.prev=13;setIsLoading(false);return _context.finish(13);case 16:case\"end\":return _context.stop();}}},_callee,null,[[0,8,13,16]]);}));return function signIn(){return _ref2.apply(this,arguments);};}();var signUp=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;setIsLoading(true);_context2.next=4;return axios({method:'POST',url:API_ROUTES.SIGN_UP,data:{email:email,password:password}});case 4:response=_context2.sent;if(response!==null&&response!==void 0&&response.data){_context2.next=8;break;}console.log('Something went wrong during signing up: ',response);return _context2.abrupt(\"return\");case 8:setNotification({error:false,message:'Votre compte a bien été créé, vous pouvez vous connecter'});_context2.next=15;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](0);setNotification({error:true,message:_context2.t0.message});console.log('Some error occured during signing up: ',_context2.t0);case 15:_context2.prev=15;setIsLoading(false);return _context2.finish(15);case 18:case\"end\":return _context2.stop();}}},_callee2,null,[[0,11,15,18]]);}));return function signUp(){return _ref3.apply(this,arguments);};}();var errorClass=notification.error?styles.Error:null;return/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(styles.SignIn,\" container\"),children:[/*#__PURE__*/_jsx(Logo,{}),/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(styles.Notification,\" \").concat(errorClass),children:notification.message.length>0&&/*#__PURE__*/_jsx(\"p\",{children:notification.message})}),/*#__PURE__*/_jsxs(\"div\",{className:styles.Form,children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:email,children:[/*#__PURE__*/_jsx(\"p\",{children:\"Adresse email\"}),/*#__PURE__*/_jsx(\"input\",{className:\"\",type:\"text\",name:\"email\",id:\"email\",value:email,onChange:function onChange(e){setEmail(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"password\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Mot de passe\"}),/*#__PURE__*/_jsx(\"input\",{className:\"border-2 outline-none p-2 rounded-md\",type:\"password\",name:\"password\",id:\"password\",value:password,onChange:function onChange(e){setPassword(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.Submit,children:[/*#__PURE__*/_jsxs(\"button\",{type:\"submit\",className:\" flex justify-center p-2 rounded-md w-1/2 self-center bg-gray-800  text-white hover:bg-gray-800\",onClick:signIn,children:[isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"\"}):null,/*#__PURE__*/_jsx(\"span\",{children:\"Se connecter\"})]}),/*#__PURE__*/_jsx(\"span\",{children:\"OU\"}),/*#__PURE__*/_jsxs(\"button\",{type:\"submit\",className:\" flex justify-center p-2 rounded-md w-1/2 self-center bg-gray-800  text-white hover:bg-gray-800\",onClick:signUp,children:[isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"mr-2 w-5 h-5 border-l-2 rounded-full animate-spin\"}):null,/*#__PURE__*/_jsx(\"span\",{children:'S\\'inscrire'})]})]})]})]});}export default SignIn;","map":{"version":3,"names":["React","useState","axios","useNavigate","API_ROUTES","APP_ROUTES","useUser","storeInLocalStorage","ReactComponent","Logo","styles","SignIn","setUser","navigate","user","authenticated","DASHBOARD","email","setEmail","password","setPassword","isLoading","setIsLoading","error","message","notification","setNotification","signIn","method","url","SIGN_IN","data","response","token","console","log","userId","signUp","SIGN_UP","errorClass","Error","Notification","length","Form","e","target","value","Submit"],"sources":["/Users/rdrouet/Documents/PERSONNEL/OCR/OCR-P7/mon-vieux-grimoire/frontend/src/pages/SignIn/SignIn.jsx"],"sourcesContent":["import React, { useState } from 'react';\nimport axios from 'axios';\nimport * as PropTypes from 'prop-types';\nimport { useNavigate } from 'react-router-dom';\nimport { API_ROUTES, APP_ROUTES } from '../../utils/constants';\nimport { useUser } from '../../lib/customHooks';\nimport { storeInLocalStorage } from '../../lib/common';\nimport { ReactComponent as Logo } from '../../images/Logo.svg';\nimport styles from './SignIn.module.css';\n\nfunction SignIn({ setUser }) {\n  const navigate = useNavigate();\n  const { user, authenticated } = useUser();\n  if (user || authenticated) {\n    navigate(APP_ROUTES.DASHBOARD);\n  }\n\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [notification, setNotification] = useState({ error: false, message: '' });\n  const signIn = async () => {\n    try {\n      setIsLoading(true);\n      const response = await axios({\n        method: 'post',\n        url: API_ROUTES.SIGN_IN,\n        data: {\n          email,\n          password,\n        },\n      });\n      if (!response?.data?.token) {\n        setNotification({ error: true, message: 'Une erreur est survenue' });\n        console.log('Something went wrong during signing in: ', response);\n      } else {\n        storeInLocalStorage(response.data.token, response.data.userId);\n        setUser(response.data);\n        navigate('/');\n      }\n    } catch (err) {\n      console.log(err);\n      setNotification({ error: true, message: err.message });\n      console.log('Some error occured during signing in: ', err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const signUp = async () => {\n    try {\n      setIsLoading(true);\n      const response = await axios({\n        method: 'POST',\n        url: API_ROUTES.SIGN_UP,\n        data: {\n          email,\n          password,\n        },\n      });\n      if (!response?.data) {\n        console.log('Something went wrong during signing up: ', response);\n        return;\n      }\n      setNotification({ error: false, message: 'Votre compte a bien été créé, vous pouvez vous connecter' });\n    } catch (err) {\n      setNotification({ error: true, message: err.message });\n      console.log('Some error occured during signing up: ', err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const errorClass = notification.error ? styles.Error : null;\n  return (\n    <div className={`${styles.SignIn} container`}>\n      <Logo />\n      <div className={`${styles.Notification} ${errorClass}`}>\n        {notification.message.length > 0 && <p>{notification.message}</p>}\n      </div>\n      <div className={styles.Form}>\n        <label htmlFor={email}>\n          <p>Adresse email</p>\n          <input\n            className=\"\"\n            type=\"text\"\n            name=\"email\"\n            id=\"email\"\n            value={email}\n            onChange={(e) => { setEmail(e.target.value); }}\n          />\n        </label>\n        <label htmlFor=\"password\">\n          <p>Mot de passe</p>\n          <input\n            className=\"border-2 outline-none p-2 rounded-md\"\n            type=\"password\"\n            name=\"password\"\n            id=\"password\"\n            value={password}\n            onChange={(e) => { setPassword(e.target.value); }}\n          />\n        </label>\n        <div className={styles.Submit}>\n          <button\n            type=\"submit\"\n            className=\"\n            flex justify-center\n            p-2 rounded-md w-1/2 self-center\n            bg-gray-800  text-white hover:bg-gray-800\"\n            onClick={signIn}\n          >\n            {isLoading ? <div className=\"\" /> : null}\n            <span>\n              Se connecter\n            </span>\n          </button>\n          <span>OU</span>\n          <button\n            type=\"submit\"\n            className=\"\n            flex justify-center\n            p-2 rounded-md w-1/2 self-center\n            bg-gray-800  text-white hover:bg-gray-800\"\n            onClick={signUp}\n          >\n            {\n                isLoading\n                  ? <div className=\"mr-2 w-5 h-5 border-l-2 rounded-full animate-spin\" /> : null\n              }\n            <span>\n              {'S\\'inscrire'}\n            </span>\n          </button>\n        </div>\n\n      </div>\n    </div>\n  );\n}\n\nSignIn.propTypes = {\n  setUser: PropTypes.func.isRequired,\n};\nexport default SignIn;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}